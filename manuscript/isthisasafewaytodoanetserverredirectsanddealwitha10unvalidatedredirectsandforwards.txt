##  Is this a safe way to do a .NET Server Redirects? (and deal with A10: Unvalidated Redirects and Forwards) 

The objective is to prevent [A10: Unvalidated Redirects and Forwards](https://owasp.teammentor.net/teamMentor#load:e6f3cc7c-d047-4915-91e9-3f6db206541e) in TeamMentor (version 3.3 had an issue with it)

Here is the code that does the redirection from user import (**_LoginReferer _**parameter):  
  
[![image_thumb[10]](images/image_thumb108.png)](file:///C:/Users/o2/AppData/Local/Temp/WindowsLiveWriter1286139640/supfiles9DE9AEB/image[30].png)

Here is the Unit test that checks for redirects that should occur:

[![image_thumb[15]](images/image_thumb158.png)](file:///C:/Users/o2/AppData/Local/Temp/WindowsLiveWriter1286139640/supfiles9DE9AEB/image[35].png)

Here is the Unit Test that checks for redirects that should fail:

[![image_thumb[16]](images/image_thumb168.png)](file:///C:/Users/o2/AppData/Local/Temp/WindowsLiveWriter1286139640/supfiles9DE9AEB/image[36].png)

A test to write next is to use FuzzDB strings (or maybe some from ESAPI or ESTAPI) in order to increase coverage.

**On that topic, is there a list of Use Cases that this function should pass? **(in order to make it as 'secure'?)

Note: the source files are on [TeamMentor's public GitHub](https://github.com/teammentor/Master) repository 
